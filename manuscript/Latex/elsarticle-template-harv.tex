
\documentclass[preprint,12pt,authoryear]{elsarticle}

%% The amssymb package provides various useful mathematical symbols
\usepackage{amssymb}
%% The amsmath package provides various useful equation environments.
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{caption} %改变图表标题
\usepackage{booktabs} %调整表格线与上下内容的间隔
\usepackage{longtable}%调用跨页表格
\usepackage{multirow} %多行合并
\usepackage{array} %调用公式宏包的命令应放在调用定理宏包命令之前，也能控制表格
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{float}
% \usepackage{hyperref}
\usepackage[colorlinks,linkcolor=red,anchorcolor=blue,citecolor=blue]{hyperref}

\usepackage{booktabs} 
%% The amsthm package provides extended theorem environments
%% \usepackage{amsthm}
%% The lineno packages adds line numbers. Start line numbering with
%% \begin{linenumbers}, end it with \end{linenumbers}. Or switch it on
%% for the whole article with \linenumbers.
\usepackage{lineno}

\journal{Remote Sensing of Environment}

\begin{document}
\captionsetup[figure]{labelfont={bf},name={Figure},labelsep=period}
\captionsetup[table]{labelfont={bf},name={Table},labelsep=period}
\begin{frontmatter}


\title{A 10 m resolution global lake database based on Sentinel-2 MSI data and deep learning} %% Article title
\author{Beihui Hu\fnref{1}}
\author{Qiuqi Luo\fnref{1}}
\author{Xuehui Pi\fnref{2}}
\author{Lian Feng\corref{cor1}\fnref{1}} %% Author name
\ead{fengl@sustech.edu.cn}
\cortext[cor1]{Corresponding author.}
%% Author affiliation
\affiliation[1]{organization={School of Environmental Science and Engineering},%Department and Organization
            addressline={Southern University of Science and Technology}, 
            city={Shenzhen},
            postcode={518055}, 
            % state={Shenzhen},
            country={China}}

\affiliation[2]{organization={***},%Department and Organization
            addressline={Tongji University}, 
            city={Shanghai},
            postcode={***}, 
            country={China}}

%% Abstract
\begin{abstract}
%% Text of abstract
It is critical to understanding the abundance and distribution of global lakes, but existing global lake databases lack comprehensive coverage of small lakes, thus hardly depict global lake distribution accurately. Here, we developed a 10 m resolution global lake database using Sentinel-2 MSI data from March 28, 2017 to April 10, 2022 (nearly five years) and a deep learning algorithm. Our GLAKESplus database covers ~12 million lakes with areas  $\ge 0.005\,\text{km}^2$, amounting to a total area of ~$3.4\times10^{6}\,\text{km}^2$, providing detailed information on their average boundaries and spatial distribution. Our results indicate that small lakes ($\le 1\,\text{km}^2$) account for 98.3\% of the total number of lakes worldwide, further highlighting the importance of small lakes in the global ecosystem. Compared with existing databases, GLAKESplus offers higher spatial resolution and more comprehensive coverage of small lakes, providing a more accurate and reliable data foundation for related research.
\end{abstract}

%%Research highlights
\begin{highlights}
\item We provide a global lake database GLAKESplus, with ~12 million lakes $\ge 0.005\,\text{km}^2$
\item Small lakes with size ($\le 1\,\text{km}^2$) dominate the global lake count (account for 98.3\%)
\end{highlights}

%% Keywords
\begin{keyword}
%% keywords here, in the form: keyword \sep keyword
Sentinel-2 \sep deep learning \sep Lake mapping

\end{keyword}

\end{frontmatter}

%% Add \usepackage{lineno} before \begin{document} and uncomment 
%% following line to enable line numbers
% \linenumbers

%% main text
%%
\section{Introduction}
\label{sec1}
% 湖泊是重要的水资源，储存了90%的地表淡水。湖泊具有许多功能，能为人类提供水源、食物和娱乐场所并减轻洪涝灾害，是众多水生生物的栖息地，也是气候变化的调节者（reynaud_global_2017；Williamson et al., 2009）。此外，湖泊在全球水文、生物地球化学及碳循环中也发挥着重要作用（Lehner & Döll, 2004; Verpoorter et al, 2016）。近几十年来，日益加剧的气候变化和人类活动影响使得湖泊在全球范围内快速变化，危害其生态系统服务（Pi et al., 2022）。例如，全球变暖使冰川、积雪大量融化，导致冰川湖泊的扩张（Shugar, D. H. et al），而人类的过度取水，正使一些盐湖逐渐干涸（Shi wei）。掌握全球湖泊的空间分布及变化十分重要，有利于相关的地球系统过程研究及水资源的调控与保护。
Lakes are vital water resources, storage 90\% of the fresh water on the surface of the Earth. Lakes serve multiple functions, such as providing water, food and entertainment for human, mitigating flood risks, acting as habitats for characteristics and integrator of climate changes \citep{williamson_lakes_2009,reynaud_global_2017,}. Additionly, lakes play an crucial role in global hydrological, biogeochemical, and carbon cycles \citep{lehner_development_2004,verpoorter_global_2014}. In recent decades, the intensifying impacts of climate change and human activities have led to rapid changes in lakes worldwide, threatening their ecosystem services \citep{pi_mapping_2022}. For example, global warming has caused significant melting of glaciers and snow, resulting in the expansion of glacial lakes\citep{shugar_rapid_2020}, while excessive water extraction by humans has led to the gradual desiccation of some salt lakes\citep{shi_longterm_2014,wurtsbaugh_decline_2017}. Understanding the spatial distribution and variability of global lakes is crucial to the study of corresponding earth system process and water resource regulation. 

% 全球湖泊数量众多，大范围、跨时间尺度的湖泊观测存在一定困难（sheng）。已有学者尝试整合多个来源的湖泊数据集来对全球湖泊空间分布进行理解。如{Lehner and Döll}编制了GLWD数据集，{messager_estimating_2016}编制了HydroLAKES数据。然而，由于数据源没有统一的分辨率及制图时间，且难以被及时更新，这些数据集不能准确体现全球湖泊分布及其变化。遥感具有覆盖面广、时效性强、信息量大的优势，随着相关技术的发展，已成为全球湖泊观测的主要方法。早期的粗分辨率卫星传感器，如AVHRR卫星的AVHRR(空间分辨率1001m)及MODIS的Terra/Aqua（空间分辨率250m至1km），仅适用于大湖泊的研究。中等分辨率卫星Landsat系列卫星提供自1972年来的免费卫星影像，被广泛应用于全球湖泊制图研究。如Verpoorter等处理了2000年左右的Landsat7上 ETM+传感器的全色锐化图像，制作了空间分辨率为14.25米的数据集GLOWABO，覆盖的最小湖泊面积为0.002 km2。Sheng等利用基于NDWI水体指数(\citep{mcfeeters_use_1996})的动态阈值分割方法处理2015年左右的Landsat8 OLI传感器 30m数据，制作了数据集Circa-2015，提供面积大于0.004 km2的全球湖泊的代表性水面积。Wang等利用Circa-2015和多个数据集编制了Prior Lake Database(PLD)数据集，覆盖全球面积大于0.01km2的湖泊。Pekel等利用专家系统对每幅Landsat影像的像素进行水分类，提供了GSWO产品，展示了水存在概率。Pi等基于GSW水概率产品，对全球湖泊在1984至2019年的面积变化进行绘制，获得了全球湖泊数据集GLAKES。GLAKES涵盖全球大于0.03 km2的湖泊，提供了研究时段内的最大湖泊边界。尽管上述基于Landsat影像的全球数据集覆盖了至小0.002km2的湖泊，但这些数据集可能包含对狭窄河流的错分现象并漏分了一些小湖泊，因为中等分辨率卫星数据在分辨小尺度的水体方面存在困难。目前，公开发布的全球湖泊数据集的最小的制图单元为PLD的0.01km2（GLOWABO和Circa-2015未公开发布），全球小湖泊的分布还没有得到准确掌握。尽管小湖泊对全球湖泊总面积的贡献较小，但其占湖泊总数量的主导地位。
Global lakes are numerous, Conducting lake observations across large spatial scales and temporal scales presents significant challenges\citep{sheng_representative_2016}. Researchers have  attempt to understand the spatial distribution of global lakes by integrating multiple lake datasets from various sources. For example, \citet{lehner_development_2004} compiled the GLWD database, while \citet{messager_estimating_2016} compiled the HydroLAKES database. However, due to the inconsistencies in data resolutions and mapping periods, as well as the difficulty of timely updates, these databases are difficult to accurately depict global lake distributions. Remote sensing offers advantages such as wide coverage, timeliness and rich information. With technological advancements, it has become the primary method for global lake observation. Early Coarse-resolution satellite sensors such as AVHRR (spatial resolution of 1001 m) and MODIS Terra/Aqua (spatial resolution of 0.25 km to 1 km) are only suitable for studying large lakes. Medium-resolution Landsat satellites provided free imagery since 1972, have been widely used in global lake mapping. For example, \citet{verpoorter_global_2014} processed pan-sharpened images from the ETM+ sensor on Landsat7 around 2000 to create the GLOWABO database, which has a spatial resolution of 14.25 meters and covers global lakes with a minimum area of 0.002 km$^2$. Similarly, \citet{sheng_representative_2016} developed the Circa-2015 dataset by applying a dynamic threshold segmentation method based on the Normalized Difference Water Index (NDWI) \citep{mcfeeters_use_1996} to process Landsat 8 OLI sensor data (30 m resolution) from around 2015. Circa-2015 providing representative water areas for global lakes with area larger than 0.004 km$^2$. \citet{wang_surface_2025} compiled the Prior Lake Database (PLD) using Circa-2015 and several databases, covering global lakes with area larger than 0.01 km$^2$. \citet{pekel_high-resolution_2016} used an expert system to classify water in each Landsat image, producing the Global Surface Water Occurrence (GSWO) product to indicate the probability of water presence. Based on GSWO, \citet{pi_mapping_2022} mapped global lake dynamics from 1984 to 2019, resulting in the GLAKES database. GLAKES covers about 3.4 million lakes with area larger than 0.03 km$^2$, providing maximum lake boundaries and time-series weighted lake areas over the study period. Although the aforementioned Landsat-based global lake databases include lakes as small as 0.002 km$^2$, they may contain misclassification of narrow rivers and omit small lakes because the limitations of medium-resolution satellite in delineating small water bodies. Currently, the smallest mapping unit of publicly available global lake datasets is 0.01 km$^2$ in PLD (as GLOWABO and Circa-2015 have not been publicly released). The worldwide spatial distribution of small lakes remain poorly understood.

% 已有研究表明小湖泊是重要的内陆水域碳通量来源，其面积变化更加剧烈。因此，有必要制作一个覆盖更多小湖泊的更全面、准确的全球湖泊数据集。随着高分辨率卫星的投入使用，这一目标成为可能。被广泛使用的高分辨率卫星Sentinel-2，免费提供全球低至10米空间分辨率的Multispectral Instrument (MSI) data，在大范围湖泊制图中有很大的优势。已有学者将其应用于区域尺度的水体制图研究，如 Yang et al. 利用2017年3月至2019年2月的sentinel-2数据对法国的地表水边界进行了月度估计，Song等使用2020年左右的sentinel-2数据对中国的城市湖泊进行了10米分辨率制图。目前还没有一个10m分辨率的全球湖泊数据集，因其需要海量遥感数据，对计算机存储及影像处理方法有较高要求。
Studies have shown that small lakes dominate the global lake count, are significant source of inland water carbon flux, and dominated the lake area variability over the past four decades \citep{holgerson_large_2016,pi_mapping_2022}. Therefore, there is a need to generate a more comprehensive and accurate global lake database with improved small-lake coverage. The increasing availability of high-resolution satellites makes this goal achievable. The widely used high-resolution satellite Sentinel-2 provides free global Multispectral Instrument (MSI) data with a spatial resolution up to 10 m, offering significant advantages for large-scale lake mapping. Researchers have already applied Sentinel-2 data to surface water mapping at regional scales. For example, \citet{yang_monthly_2020} processed Sentinel-2 imagery from March 2017 to February 2019, to estimate the monthly extent of surface water in France. \citet{song_high-resolution_2022} generated a 10 m resolution map of urban lakes in China using Sentinel-2 imagery around 2020. Currently, a 10 m resolution global lake database is not available, as it requires massive remote sensing data, placing high demands on computer storage and image processing methods.

%近年来出现的遥感云计算平台使海量遥感数据处理变得容易，减少了对本地存储的要求。其中，被广泛使用的Google Earth Engine（GEE）云计算平台提供PB级的20 petabytes的行星尺度遥感、地理数据，及高性能、并行的计算处理服务（Gorelick）, 被广泛应用于各个领域。此外，新兴的深度学习方法在海量遥感影像处理方面有巨大优势。深度学习方法指构建具有多个加工层的计算模型，对输入数据进行抽象表征（Yann LeCun），具有准确率高、速度快、自动化程度高的优点。深度学习已被用于大范围湖泊制图领域，例如，前文提到的30m分辨率湖泊数据集GLAKES就是由深度学习方法制作而成。在高分辨率制图方面，Li等利用深度学习方法处理哨兵2号数据，实现了国家尺度地表水体的自动制图。Ankush Manocha提出了一种基于深度学习的特征融合方法，基于哨兵2号影像进行水体制图，在特定区域得到良好效果。结合GEE云平台、深度学习方法与Sentinel-2遥感影像，10米分辨率的全球湖泊制图成为可能。
Recent advances in cloud computing platforms have improved the efficiency and accessibility of processing massive remote sensing data, reducing the demand for local storage. Among them, the Google Earth Engine (GEE) platform provides multi-petabyte geospatial datasets and high-performance computation services, is widely used in various disciplines \citep{gorelick_google_2017}. In addition, emerging deep learning techniques methods have significant advantages in processing massive remote sensing data. Deep learning refers to the construction of computational models with multiple processing layers, which learn representations of input data through varying levels of abstraction \citep{lecun_deep_2015}. It offers advantages such as high accuracy, fast processing speed, and a high degree of automation, has been applied to large-scale lake mapping. For example, the aforementioned 30 m resolution global lake database, GLAKES, were generated by deep learning algorithm. In the field of high-resolution water mapping, \citet{li_automatic_2021} employed deep learning to Sentinel-2 data, achieving automated surface water mapping at the national scale. \citet{manocha_mapping_2023} proposed a deep learning-based feature fusion method for water body mapping using Sentinel-2 imagery, which yielded good results in specific regions. By integrating the GEE cloud platform, deep learning methods, and Sentinel-2 imagery, global lake mapping at a 10 m resolution has become feasible.

% 基于先前的研究，本研究的目的是利用Sentinel-2 MSI数据及深度学习方法，对全球面积大于0.005km2的湖泊和水库（以下简称 “湖泊”）进行10米分辨率制图，提供数据集GLAKESplus。具体包括：1）在GEE云平台上获得并处理全球Sentinel-2影像；2）训练一个适用于Sentinel-2全球湖泊制图的语义分割模型；3）对全球湖泊分布进行制图及分析，并将结果与其他数据集进行对比。
Motivated by previous research, this study aims to use Sentinel-2 MSI data and a deep learning algorithm to map global lakes and reservoirs (hereafter simply “lakes”) with area larger than 0.005 km$^2$. The specific research objectives include: 1) Acquiring and processing global Sentinel-2 imagery on GEE; 2) Training a semantic segmentation model for lake prediction on global Sentinel-2 imagery; and 3) Generating and analyzing the global lake distribution, then comparing it with existing global lake databases.

\section{Materials and methods}
\label{sec2}
%GLAKESplus的制作过程如下：1) 影像处理，研究时段内的Sentinel-2数据的NDWI、红、绿、蓝及近红外波段的逐像素平均结果被计算，随后被分片下载至本地存储；2) 样本准备，全球范围内的样本区域及湖泊标签被创建，用于制作训练数据集（由训练集、验证集、测试集组成）；3)模型应用，U-Net模型被训练来从预处理影像中提取湖泊特征，并预测出了原始全球湖泊分类图；4)后处理，我们进行了若干后处理步骤来减少原始全球湖泊分类图中错分、漏分的现象，最终生成了GLAKESplus湖泊多边形。技术路线如Fig. 1所示。
The production process of GLAKESplus was as follows: 1) Image preprocessing, where the pixel-wise average of the NDWI, red, green, blue, and near-infrared bands of Sentinel-2 data from the study period were calculated and downloaded in slices to local storage. 2) Sample preparation, where worldwide samples were generated to form a training dataset (divided into training, validation and test sets). 3) Model application, where a U-Net model was trained to extract lake features from sentinel-2 images and predict a raw global lake classification map. 4) Post-processing, where several post-processing steps were applied to reduce commission and omission errors in the raw global lake classification map, ultimately producing the GLAKESplus database. The flowchart is illustrated in Fig. \ref{fig:Fig1}.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\linewidth]{figure/Figure1_flowchart.pdf}
    \caption{Flowchart for developing the GLAKESplus database, including pre-processing, sample preparation, model application, and post-processing steps.}
    \label{fig:Fig1}
\end{figure}

\subsection{Sentinel-2 data and preprocessing}
\label{subsec1}

%Sentinel-2是欧洲航天局( ESA )哥白尼计划的下的一个地球观测任务，由2015年发射的Sentinel-2A 及2017年发射的Sentinel-2B组成，重访周期为2~5天。Sentinel-2的B2(蓝光)、B3(绿光)、B4(红光)及B8 (近红外)波段空间分辨率为10米，可以展示精细的湖泊边界。其短波红外波段（B11,B12）空间分辨率为20 m,其余波段空间分辨率为60 m。Sentinel-2的Level-2A数据集是地表反射率标准产品，去除了大气效应，相比TOA产品更具一致性。我们选择了Sentinel-2 L2A产品的三个可见光波段（B2,3,4），一个短波红外波段B11波段及NDWI指数，来绘制全球湖泊。NDWI是一个常用的水体增强指数，计算公式为（Band_green-Band_red）/（Band_green-Band_red）。在Sentinel-2中，Band_green和Band_red分别为B3波段、B8波段。NDWI能够抑制植被信息，增强水体信息，但在区分水体和建设用地方面有些困难，如先前研究所述(Xu)。引入短波红外波段的信息能够弥补NDWI指数的缺陷，因为在SWIR波段，建设用地通常有较高的反射率，水体的反射率则较低。值得注意，我们将SWIR波段重采样至10m，与我们使用的其他波段一致。
Sentinel-2 is an earth observation mission under the Copernicus program of the European Space Agency (ESA), consisting of Sentinel-2A (launched in 2015) and Sentinel-2B (launched in 2017), with a revisit period of 2 to 5 days. The B2 (blue), B3 (green), B4 (red), and B8 (near-infrared) bands of sentinel-2 have a spatial resolution of 10 m, enabling the delineation of finer lake boundaries, while the shortwave infrared bands (B11, B12) have a spatial resolution of 20 m. The Sentinel-2 Level-2A procuct is an surface reflectance (SR)standard product that removes atmospheric effects, providing more consistency compared to the top of the atmosphere (TOA) reflectance product. Here, we selected three visible bands (B2, B3, B4), one short-wave infrared band (B11), and the Normalized Difference Water Index (NDWI) \citep{mcfeeters_use_1996} from Sentinel-2 L2A procuct to map global lakes. The NDWI is a commonly used water enhancement index, calculated as:
\begin{equation}
NDWI = (Green-Nir)/(Green+Nir)
\end{equation}
In Sentinel-2 L2A product, Green and Nir correspond to B3 and B4 bands, respectively. NDWI effectively suppresses vegetation signals and enhances water features. However, it has limitations in distinguishing water bodies from built-up areas, as noted in previous studies \citep{xu_modification_2006}. Incorporating SWIR band information helps mitigate this issue, as built-up areas typically have higher reflectance in the SWIR band, while water bodies exhibit lower reflectance. Notably, we resampled the SWIR band to 10 m, consistent with that of other bands we used.

%具体来说，我们在GEE上获得了2017年3月28日至2022年4月10日（约5年）的所有云像素比例低于60%的Sentinel-2 L2A影像，并进行了若干预处理操作。首先，哨兵云概率产品(S2 Cloud Probability, S2Cloudless)被用去云像素。S2Cloudless是使用 sentinel2-cloud-detector 库创建的，其提供了每幅影像的单个像素的云概率。根据经验，对所有云概率高于50%的像素进行掩膜操作，并将近红外波段的暗像元与云投影取交集，去除云阴影像素。并且，部分冰雪像素被通过场景分类图层 (Scene Classification Layer, SCL)去除。场景分类图层是L2A产品的一个波段，提供对云、云阴影、冰雪、水体的初步的分类。随后，我们计算了每个像素和每幅影像的NDWI指数。单幅影像上的湖泊可能因掩膜操作而缺失像素，并且其水体信息可能受云残留、藻华、泥沙等因素的干扰。因此，我们将研究时段内影像进行逐像素平均，获得一个均值合成影像。均值合成影像能够对单幅影像的噪声因素进行平滑，并捕捉湖泊的在研究时段内的平均边界。最终，约10TB的均值合成影像被分片下载至本地计算机，作为后续湖泊识别的源数据。
Specifically, using the GEE platform, we obtained Sentinel-2 L2A images with label “percentage of cloud pixels” $\lt60\%$ from March 28, 2017 to April 10, 2022 and performed several preprocessing operations. First, the Sentinel-2 cloud probability product (S2Cloudless) was used to remove cloud pixels. All pixels with a cloud probability greater than 50\% were masked, and cloud shadow pixels were filtered using NIR band dark pixels and cloud projection intersections. Additionally, snow and ice pixels were masked using the Scene Classification Layer (SCL) of Sentinel-2 L2A products. Subsequently, we calculated the NDWI index for each pixel and image. In single satellite images, lakes may have missing pixels due to masking operations, and their signals may be affected by other factors (i.e. cloud residues, algal blooms, and sediment plumes). Therefore, we performed pixel-wise averaging of images within the study period to obtain a mean composite image, which smooth out noise factors from individual images and captures the average boundaries of lakes during the study period. Finally, approximately 10 TB of the mean composite image were downloaded in tiles to the local computer as basemap for subsequent lake identification.

\subsection{Sample preparation}
\label{subsec2}

%我们在全球范围选择具有代表性的样本区域，用于制作模型训练所需的标签。针对每一个样本区域，我们通过基于NDWI波段的阈值分割法获得初步标签，阈值由人工确定。随后，非常耗时的人工修改被应用，以去除初步标签中的错分、漏分误差，获得最终标签。在Sentinel-2影像中，湖泊的NDWI值通常比背景高，在RGB、SWIR波段反射率较低，形状偏圆形，表面平坦，易于和背景区分。易于区分的区域被我们标记成（1）普通区域（Normal Regions, NR）；此外，我们还观察到几种需要仔细辨认的区域，分别为（2）河边湖泊区域 (Alongside Rivers Regions, AR)，地表水形态多样，需要仔细区分河流与湖泊（尤其是与河流形态相似的牛轭湖）；（3）建成区域（Built-up Regions, BR），建筑及其阴影在NDWI中易被误判为湖泊，需要结合其他4个波段进行剔除；（4）冰川湖区域(Ice Rgions, IR)，冰川在NDWI波段及SWIR波段的特征与湖泊相似，需要结合可见光波段删除错分的冰川，并仔细区分冰川湖的边界；（5）盐湖区域（Salt Lakes Regions,SL），盐湖多分布于干旱与半干旱地区，常含有盐类沉积，其NDWI的分割阈值较普通湖泊低，并在可见光和短波红外波段中表现出高反射率，需要仔细分辨；最终，我们选择并绘制了799个的样本标签，并按照分层随机采样方法，将其划分为训练（60％），验证（20％）和测试（20％）集。样本区域的空间、大小分布及统计信息如Fig. 3所示。需要指出，样本区域的类别依据该区域的主要特征确定。
We selected representative sample regions globally and manually labeled lake boundaries for model training. For each sample region, we initially generated lake labels using a threshold-based segmentation method on the NDWI band, with thresholds determined manually. Extensive manual refinement was then performed to remove commission and omission errors ensuring high-quality final labels. In the basemap, lakes typically have higher NDWI values than the background, lower reflectance in the visible bands and SWIR band, and a round and flat shape, making them easy to distinguish from the background. Regions that were easy to distinguish were labeled as (1) Normal Regions (NR). Additionally, we observe several regions requiring careful identification: (2) Alongside Rivers Regions (AR), where surface water bodies exhibit diverse morphologies, requiring careful differentiation between rivers and lakes, especially oxbow lakes, which share similar shapes with river channels; (3) Built-up Regions (BR), where buildings may be misclassified as lakes in the NDWI band and need to be removed using other four bands; (4) Ice Lake Regions (IL), where the glaciers have similar features to lakes in the NDWI and SWIR bands, requiring careful delineation of lake boundaries; (5) Salt Lakes Regions (SL), salt lakes are primarily found in arid and semi-arid regions, often containing salt deposits. They typically exhibit lower NDWI threshold values exhibit lower NDWI threshold values, and display high reflectance in both visible and SWIR bands, necessitating careful differentiation. Finally, A total of 799 labeled sample regions were created and stratified into training (60\%), validation (20\%) and test (20\%) sets following the stratified random sampling method. The spatial, size distribution, and statistical information of the sample regions are shown in Fig. \ref{fig:Fig2}. To be notice, the sample type of each region was defined by their dominant features.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\linewidth]{figure/Figure2_sample_istribution.eps}
    \caption{Spatial distribution and statistical characteristics of sample regions. (a) Global spatial distribution of sample regions, categorized into five region types: NR, AR, BR, IL and SL. Different colors represent the dataset splits: training (sky blue), validation (orange), and test (green). (b) Histogram of sample region sizes with different dataset splits stacked for visualization. (c) Summary statistics of sample regions, including the count of regions and their total area for each region type.}
    \label{fig:Fig2}
\end{figure}

\subsection{Model application}
\label{subsec3}

%深度学习方法已经成为过去几十年人工智能领域的主要驱动及过程，已在语音识别、视觉物体识别及检测等领域获得显著进步，也在近几年被应用于遥感领域(Zhu,Brandt et al., 2020)。卷积神经网络CNN是深度学习的典型代表，由卷积层、池化层、激活函数和全连接层等部分组成。卷积层对前一层的输入特征进行卷积运算，即使用不同的卷积核提取不同的图像特征。池化层对输入特征进行下采样，减少网络参数量和计算复杂度，压缩特征使其更抽象、更概括。卷积和池化操作是线性过程，在卷积操作之后引入的激活函数能使网络进行非线性表达能力。全连接层则是将二维的特征图映射为一维向量，输出分类结果。在语义分割领域，Shelhamer等提出了全卷积神经网络FNN，将卷积神经网络的的全连接层替换成卷积层，并使用上采样恢复图像尺寸，实现了对任意大小图像的分割。
Deep learning has become a key driver and process of artificial intelligence \citep{brandt_unexpectedly_2020}, achieving significant advancements in areas such as speech recognition and visual object recognition \citep{zhu_deep_2017}, were widely used in remote sensing fields over the several years \citep{zhu_deep_2017}. Convolutional Neural Networks (CNNs) are a typical representation of deep learning methods, consisting of convolutional layers, pooling layers, activation functions, and fully connected layers. The convolutional layer performs convolution operations on the input layer, using convolution kernels to extract image features. The pooling layer downsamples the input features, reducing the number of network parameters and computational complexity while compressing features to make them more abstract and generalized. The activation function introduced after convolution operations enables the network to achieve nonlinear representation capabilities. The fully connected layer maps the two-dimensional feature map into a one-dimensional vector to output classification results. In the field of semantic segmentation, \citet{shelhamer_fully_2017} proposed the Fully Convolutional Neural Network (FCNN), which replaces the fully connected layers of a convolutional neural network with convolutional layers and employs upsampling to restore image dimensions, enabling the segmentation of images of arbitrary sizes.

%然而，将深度学习语义分割模型应用至医学影像、遥感影像，存在着训练数据不足的问题。训练数据不足易导致模型过拟合，即在训练数据上表现出高准确性，在测试集上表现出低准确性。针对医学影像识别面临的训练数据不足问题，{ronneberger_u-net_2015}利用数据增强技术对训练数据集进行扩充，利用滑动窗口获得数量远大于训练影像的局部区域（patch），提出了一个全卷积神经网络架构U-Net。U-Net网络左侧可视为一个编码器 (Encoder)，能够提取 hierarchical features。网络右侧可视为一个解码器 (Decoder)，能够通过上采样重建空间信息。在编码与解码过程中，U-Net通过Skip connections将深层与浅层特征进行融合，提高语义分割精度。结合重叠-切片 (overlap-tile) 策略，U-Net可对任意大的图像进行无缝分割。U-Net已被证明具有较高的准确性及高效的计算性能，被应用于多个领域，包含大范围遥感制图。例如，Brandt等人利用了优化的U-Net模型，对撒哈拉沙漠的树目进行识别；Pi等在Brandt等人的模型上进行微调，将U-Net运用到全球湖泊制图领域并获得良好效果。因此，我们基于Pi等的代码上进行调整，将U-Net应用于基于Sentinel-2影像的全球湖泊10 m分辨率制图。和Pi等一致，我们没有使用dropout层，并在U-Net模型的每一个卷积层后添加了批量归一化层。批量归一化层将网络中的数据分布转换为正态分布，能降低网络梯度消失现象，加快收敛速度并提升网络的泛化能力，减少过拟合现象。
Applying deep learning models to remote sensing imagery faces the challenge of insufficient training data. A lack of training data may lead to model overfitting, which means exhibiting high accuracy on the training set but low accuracy on the test set. To address this issue of medical image segmentation, \citet{ronneberger_u-net_2015} proposed a fully convolutional neural network architecture called U-Net, utilized data augmentation techniques to expand the training dataset, and used sliding windows to get a large amount of local regions (patches) from training dataset \citep{ronneberger_u-net_2015}.  Combined with the overlap-tile strategy, U-Net enables seamless segmentation of arbitrarily large images. The left side of U-Net functions as an encoder, extracting hierarchical features, while the right side of U-Net acts as a decoder, reconstructing spatial information through up-sampling. During the encoding and decoding process, U-Net fuses deep and shallow features via skip connections, thereby improving the accuracy of semantic segmentation. U-Net has been proven to achieve high accuracy and computational efficiency, making it widely applicable across various fields, including large-scale remote sensing mapping. For instance, \citet{brandt_unexpectedly_2020} employed an improved U-Net model to map tree in the West African Sahara and Sahel. \citet{pi_mapping_2022} modified \citep{brandt_unexpectedly_2020}'s U-Net model to map global lake at a 30 m spatial resolution, achieving promising results. In this study, we made some changes of \citet{pi_mapping_2022}'s code, applying U-Net to Sentinel-2 imagery to map global lake at a 10 m resolution. Same as \citet{pi_mapping_2022}, we did not use Dropout layer and integrated batch normalization (BN) layers \citep{ioffe_batch_2015} after each convolutional layer in the U-Net model. BN transforms the data distribution into a normal distribution, mitigating gradient vanishing, accelerating convergence, enhancing generalization, and reducing overfitting.

%训练深度学习网络的过程，本质上是通过最小化损失函数，使模型预测结果尽可能接近真实标签。误差反向传播 (Back-propagation, BP) 使训练过程在计算上易于处理，此算法计算神经网络中损失函数对各参数的梯度，配合优化算法更新参数，使损失函数最小化。针对我们的研究，我们采用了dice loss损失函数及与Pi等一致的Adadelta优化算法。在训练数据集中，湖泊标签的尺度变化大，正负样本的分布不均匀。骰子损失是一种区域相关的损失函数，在在正负样本严重不平衡的场景有着不错的性能。
The process of training a deep learning network fundamentally involves minimizing the loss function to align model predictions as closely as possible with ground truth labels. Backpropagation (BP) makes the training process computationally feasible by calculating the gradients of the loss function with respect to each parameter in the neural network. These gradients are then used alongside optimization algorithms to update the parameters and minimize the loss function. For our study, we selected dice loss \citep{sudre_generalised_2017} as loss function and used the same optimizer as \citet{pi_mapping_2022}. Dice loss measures the overlap between the predicted segmentation mask and the ground truth, performing well in scenarios with severe class imbalance and ensuring balanced attention to both small and large structures. 

%训练集被用于模型训练，验证集则被用于保存最佳模型（具体的，我们保留在验证集上loss error最小的模型）。由于我们的GPU内存的限制（48GB），模型输入被设定为576×576×5，批处理个数为16个。和pi等一致，我们使用随机采样方法，从训练集、测试集中生成与模型输入大小一致的patches。在随机选择时，我们引入概率参数，使每个样本区域被选中的概率与其大小成正比，从而避免对大样本的欠采样和对小样本的过采样；我们没有对输入模型的部分patch进行局部归一化操作，当patch内正负样本极不均衡时，该方法会改变NDWI波段的特征，降低模型的预测能力。模型训练过程中采用了early stopping策略来自动设置迭代次数。通过实践，初始迭代次数被设置为200次，当连续50个epoch的val loss没有降低时，训练会被提前终止。 
The training set was employed for model optimization, while the validation set served to preserve the best-performing model (specifically, we retained the model exhibiting the lowest loss error on the validation set). Due to GPU memory constraints (our GPU memeary was 48 GB), the model input size was set to 576×576 with a batch size of 16. Since the sample regions were too large for model input, a random sampling method was used to generate patches with fixed size (same as input, 576×576). The probability of each sample region being randomly selected was proportional to its size to avoid undersampling large regions and oversampling small regions. We did not use local normalization for input patches, this operations may distort characteristics in NDWI band thus degrade the model performance. We keep the model with the smallest loss error on validation set were used to save the best model. The number of training iterations (epoch number) is another critical hyperparameter in model training. Early stopping strategy were used to automatically determine the epoch numbers. In our study, the maximum number of training epochs was 200, while training would automatically terminating when the validation loss failed to improve for 50 consecutive epochs.

%测试集被应用于模型精度评价，结果在section3.1中被详细阐述。最终获得的模型被用于对sentinel-2格网影像进行湖泊预测。在预测过程中，我们使用固定步长，从左到右，从上到下移动的sliding window，将一幅影像裁剪为与模型输入一致的patchs，作为模型的输入。随后，每个patch的预测结果被拼接成该幅影像的结果。影像和patch的边缘上下文信息不足，为了提升预测结果的准确性，对每幅格网影像增加了0.01°的边缘信息，并舍弃每一个patch边缘一定宽度的预测值。为了兼顾预测效率及准确性，舍弃边缘宽度被设置为100像素，滑动窗口的左右、上下方向的步长被设置为376。将全球格网影像的预测结果合并后即可获得初步制图结果。
After training, the final model were used to predict lakes from global grid images. A sliding window was used to crop large grid images into small patches. The prediction of each patch was stitched together to form raw global lake classification map. To improve accuracy, the prediction of edge pixels within a 100-pixel margin of each patch were discarded due to the insufficient contextual information at the edges. 

\subsection{Post processing}
\label{subsec4}

%为了提升初步结果的预测精度，我们采取了几步后处理操作。受限于相对小的输入大小，深度学习模型难以区分局部特征与大湖泊类似的海洋及大河宽河流。因此，我们利用现有数据集来去除海洋、河流残留。OSM(Goodchild, 2007)的Coastline data sets被用于去除海洋残留。可以从 https://osmdata.openstreetmap.de/data/获得。 首先，所有不在Land polygon海洋像素被去除。随后，所有与ocean polygon相交的polygon被进一步删除，以去除OSM未完全覆盖的海洋残留。同时，与海洋相连的泻湖也被删除。泻湖没有被纳入我们的考虑范围，因其特性与内陆湖泊十分不同。我们采纳并修改了Pi等的方法，来去除河流残留。首先，我们利用Global River Widths from Landsat (GRWL)数据集及OSM的河流图层，去除初步结果中的河流像素。随后，我们保留了与水库数据集（OSM的水库数据及GeoDAR数据集）相交的水库polygon。OSM的河流、水库数据由OSM的全球数据（https://planet.openstreetmap.org/）中提取。随后，我们利用GLAKES数据集及每一个polygon的area ratio来改进河流掩膜结果。AR的计算公式为
Several post-processing operations were applied to the raw global lake classification map. Due to the relatively small input size, the deep learning model struggled to distinguish local features similar to large lakes, such as oceans and rivers with large widths. Thus, we removed oceanic and river residuals by other databases. The coastline data sets of Openstreetmap (OSM) \citep{goodchild_citizens_2007} were used to remove ocean residuals. Its land polygons can be downloaded from https://osmdata.openstreetmap.de/data/land-polygons.html . All polygons that were not within land polygons were considered as ocean residuals and been removed. Lagoons connected to the ocean were not included in our consideration because their different characteristics from inland lakes. To remove river residuals, we adopted and modified the method proposed by \citet{pi_mapping_2022}. Firstly, we use OSM river data and the Global River Widths from Landsat (GRWL)\citep{allen_global_2018} database to remove river pixels from the raw global lake classification map. Subsequently, we retained reservoir polygons that intersected with other reservoir datasets,including the GeoDAR dataset \citep{wang_surface_2025} and OSM reservoir data. The river and reservoir data from OSM were extracted from OSM's global dataset (https://planet.openstreetmap.org/). Next, we improved the accuracy of river masking using the GLAKES dataset and the Area Ratio (AR) of each polygon. The AR is calculated using the following formula:
\begin{equation}
Area Ratio = Area_{after\ mask}/Area_{before\ mask}
\end{equation}
%其中Area_(before mask)和Area_(after mask)分别代表这个polygon在河流掩膜前后的面积。当Area Ratio越接近1，表明这个polygon越可能是与河流相连的湖泊，当AR接近0，表明其更可能是河流残留。具体的，与GLAKES相交且Area Ratio大于0.8的polygon (Fig. 3a)，从而保留与河流相连的湖泊。不与GLAKES相交且 Area Ratio 小于0.8 的polygon被整个删除，因其基本上是河流残留(Fig. 3d)。其他情况下，初步掩膜后的结果被保留（Fig. 3b, c）。随后我们进行了大量人工检查和修改，最终完成河流掩膜。
Where $Area_{before\ mask}$ and $Area_{after\ mask}$ represent the area of the polygon before and after river masking, respectively. Polygons with AR closer to 1 are more likely to be a lake connected to a river. Conversely, polygons with AR closer to 0 are more likely to be a river residuals. Specifically, polygons intersecting with GLAKES with AR > 0.8 were retained as river-connected lakes (Fig. \ref{fig:Fig3}a). Polygons not intersecting GLAKES with AR < 0.8 were entirely removed, as they are essentially river residuals (Fig. \ref{fig:Fig3}d). In other cases, polygons after initial mask were retained (Fig. \ref{fig:Fig3}b, c). Finally, extensive manual inspection were performed to minimize errors.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\linewidth]{figure/Figure3 River mask.png}
    \caption{Post-processing of river mask and the corresponding results. (a) Target polygons intersect with GLAKES with an area ratio $\geq$0.8; (b) Targets polygon not intersect with GLAKES with an area ratio $\geq$0.8; (c) Targets polygon intersect with GLAKES with an area ratio $<$0.8; (d) Targets polygon not intersect with GLAKES with an area ratio $<$0.8.}
    \label{fig:Fig3}
\end{figure}

%我们设定最小湖泊面积阈值为0.005km2 ，删除了所有小于阈值的polygon；经以上操作，初步预测结果中的错分误差被基本消除，但初步结果仍存在一些漏分误差。受限于输入大小，部分大湖泊的局部因特征与河流相似而被模型遗漏。此外，在Sentinel-2平均底图中，干旱区湖泊因较高的地表反射率易被模型误认为陆地。因此，我们利用GLAKES数据集和PLD数据集进行湖泊补全。GLAKES已被证明在全球大湖泊绘制上的准确性，其提供的多年最大湖泊边界覆盖全面，适用于大湖泊补全。PLD是一个整合了多个数据集的全球湖泊数据集，覆盖的最小湖泊面积为0.01km2。其主要数据源Circa-2015提供了2015年左右的全球代表性水面积，已被证明对大洋洲高度动态的湖泊的良好捕捉 (Sheng et al., 2016)。因此，PLD数据集被用于干旱区湖泊补全。我们定义的干旱区指Arid Index<0.2的区域，利用干旱指数数据集 (Zomer et al., 2022)获得。
Based on the accuracy assessments results (Fig. \ref{fig:Fig5}), we set the minimum lake area threshold as 0.005 km$^2$ and removed all polygons smaller than this threshold. After the above operation, the commission errors of raw global lake classification map were largely eliminated. We further performed a lake-completion operation to reduce the omission error. Because of the limited input size, our model failed to capture parts of large lakes that exhibit features similar to rivers. Additionally, in the Sentinel-2 mean basemap, lakes in arid regions were often misclassified as land due to their high surface reflectance. GLAKES has been proven accurate for mapping large global lakes, providing comprehensive maximum lake boundaries over multiple years, making it suitable for large lake completion. Additionally, PLD \citep{wang_global_2022} is a global lake database integrating multiple data sources, with a minimum lake coverage area of 0.01 km$^2$. Its primary data source, Circa-2015, has shown good performance of highly dynamic lakes in Oceania \citep{sheng_representative_2016}. Therefore, the PLD dataset was used to supplement lakes in arid regions. We defined arid regions as areas with an Arid Index < 0.2, obtained form the Arid Index database\citep{zomer_version_2022}.

% 合并前，我们对GLAKES数据集进行了处理，以去除其中因不全面的洪泛平原定义而包含的错分误差。SHIFT数据集是一个基于DEM映射的90 m分辨率的全球地貌洪泛区，比现有的洪泛区数据更全面。我们利用30%occurren阈值对GLAKES在SHIFT数据集 (Zheng et al., 2024) 内的非干旱区的湖泊进行掩膜。更新的洪泛平原掩膜操作不仅有效地去除了GLAKES中错分的洪泛平原，使连片的湖泊群得以分离 (Fig. 4a, b), 也有效去除了常分布于洪泛平原中的因季节性蓄水而被错分为湖泊的水稻田 (Fig. 4c, d)。
Before merging, we processed the GLAKES dataset to remove misclassification errors within floodplains. For examples, xxx.  SHIFT \citep{zheng_shift_2024} is a global geomorphic floodplain dataset based on DEM-mapping with a 90 m resolution, offering a comprehensive coverage of floodplains. We applied a 30\% occurrence threshold to mask GLAKES within the SHIFT dataset and outside arid regions, effectively removed the floodplain residuals (Fig. \ref{fig:Fig4}a, b) and agriculture zones (Fig. \ref{fig:Fig4}c, d). 

\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\linewidth]{figure/Figure4 GLAKES flood mask.png}
    \caption{Comparison of GLAKES before and after applying the flood mask. (a) and (b) demonstrate that the flood masking operation effectively removed misclassified floodplains, while (c) and (d) illustrate its effectiveness in eliminating misclassified paddy fields. For (a-d), the left figures show the water occurrence (ranging from 0 to 100) and GLAKES polygons before mask (orange line), the right figures show the GLAKES polygons after mask (blue).}
    \label{fig:Fig4}
\end{figure}

%最终，经洪水掩膜的GLAKES数据集中大于1 km2的自然湖泊及所有水库，及所有位于干旱区中的PLD湖泊，被合并至初步预测结果中。经过大量人工检查和修改，得到了最终预测结果GLAKESplus数据集。
Finally, natural lakes larger than 1 km$^2$ and all reservoirs from the floodplain-masked GLAKES dataset, along with all PLD lakes located in arid regions, were merged into the raw global lake classification map. After extensive manual inspection and modification, the final global lake classification map was compiled GLAKESplus dataset.

\section{Results}
\label{sec3}

\subsection{Accuracy assessments}
\label{subsec31}

%158个样本区域组成的独立测试集，被用于精度评估。我们使用的评价指标包含Recall, Precision，F1score及IoU。Recall是正确湖泊预测占真实湖泊标签的比例，precision是正确湖泊预测占所有湖泊预测的比例；F1 Score则是Recall和Precision的harmonic average，接近这两个数字的最差值；IoU为正确湖泊预测占湖泊标签与湖泊预测的并集的比例。因为非湖泊标签占标签的主导，我们没有使用mIoU和overall accurracy，避免大量正确非湖泊预测影响精度评价结果。首先，我们评估了模型在patch尺度上的表现。共有2424个576×576大小的patches依据顺序采样方法从测试集中获取，并被用于分类别精度评价（Table 1）。总体上，模型表现出较好的结果，IoU达到87.5，其他指标高于92.7。在不同区域类别上，模型表现稍有差异。在region AR上,模型的 precision及IoU偏低（分别为89.77%及84.28%，Table 1），存在对大河流的错分（Supplementary Figure 1c）。在占比较少的region  SL样本上，模型的recall及IoU偏低（分别为72.71%及69.80%，Table 1），存在对盐湖的漏分（Supplementary Figure 1f），模型在其他区域上（NR、BR、IL）上表现良好。
An independent test set consisting of 158 sample regions was used to evaluate the model classification accuracy. The assessment metrics included Recall, Precision, F1 score and IoU. Recall represents the proportion of correctly predicted lakes among lake labels, while precision represents the proportion of correctly predicted lakes among predicted lakes; F1 score is the harmonic average of Recall and Precision, and IoU represents the proportion of correctly predicted lakes to the union between lake labels and prediction. First, we evaluated model performance at the patch level. A total of 2424 patches (each 576×576 pixels) were extracted sequentially from the test set for type-wise accuracy assessment (Table \ref{tabel1}). Overall, our model showed good performance with IoU of 87.5\% and other metrics exceeding 92.7\%. Performance varied slightly across different region types. In AR regions, precision and IoU were relatively lower (89.77\% and 84.28\%, respectively; Table \ref{tabel1}), primarily due to the river residues of large rivers (Supplementary Figure 1c). In SL regions, our model exhibited lower recall and IoU (72.71\% and 69.80\%, respectively; Table 1), primarily due to the omission of salt lakes (Supplementary Figure 1f). Overall, our model performed well in other regions (NR, BR, and IL). 

%将测试集预测结果进行合并后，我们对河流掩膜操作进行整体上的精度评价（Table 2），并进行了湖泊尺度上的精度评价（Figure 5）。结果表明，河流掩膜操作使precision提高了1.77%，recall略微降低0.1%，河流掩膜操作去除的预测值的真实湖泊预测面积趋近0（Fig. 5a）。
After merging the prediction results from the test set, we conducted an overall accuracy evaluation of the river masking operation (Table \ref{tabel2}) and performed a lake-scale accuracy assessment (Fig. \ref{fig:Fig5}). The results indicated that the river mask operation improved Precision by 1.77\% (Table \ref{tabel2}), the true predicted area after removing the river residuals approached zero (Fig. \ref{fig:Fig5}a). 

\begin{table}[t]
    \centering
    \caption{Accuracy assessments of our developed deep-learning algorithm at patch level with different region type.}\label{tabel1}
    \begin{tabular}{cccccc}
    \toprule
    Region type & Patch count & recall (\%)	& precision (\%) & F1 (\%) & IoU (\%) \\
    \midrule
    NR & 798 & 93.00 & 96.26 & 94.29 & 89.71 \\
    AR & 698 & 93.08 & 89.77 & 91.08 & 84.28 \\
    BR & 308 & 95.78 & 90.83 & 93.16 & 87.29 \\
    IL & 522 & 96.79 & 94.76 & 95.72 & 91.87 \\
    SL & 98 & 72.71 & 95.60 & 81.46 & 69.80 \\
    total & 2424 & 93.37 & 93.35 & 92.70 & 87.50 \\
    \bottomrule
    \end{tabular}
    
\end{table}

\begin{table}[t]
    \centering
    \caption{The improvement of river mask operate in test regions}\label{tabel2}
    \begin{tabular}{ccccc}
    \toprule
     & recall (\%)	& precision (\%) & F1 (\%) & IoU (\%) \\
    \midrule
    Before river mask & 93.50  & 92.95  & 93.22  & 87.31 \\
    After river mask & 93.40  & 94.72  & 94.05  & 88.78 \\
    \bottomrule
    \end{tabular}
\end{table}

%湖泊尺度上，正确预测面积与其对应的标签面积及预测面积表现出强相关性，R方都是0.98，斜率大于0.92，但在小湖泊尺度上，正确湖泊预测面积与标签的相关度稍低（Fig. 5a）。在大于0.005km2的湖泊尺度组上，标签的平均召回率和预测值的平均精准度皆高于86%，并随湖泊尺度增加而提升。值得注意的是，在[1~20km2]的尺度组上标签的平均召回率为93.1%，略低于[0.1-1km2]尺寸组的95.5%。
At the lake scale, the true predicted area showed strong correlations with both corresponding labeled area and the predicted area, with $R^2$ values of 0.98 and slopes greater than 0.92 (Fig. \ref{fig:Fig5}a). However, the correlation between the true predicted area and the labeled area was slightly weaker for smaller lakes (Fig. \ref{fig:Fig5}a). For lakes larger than 0.005 km$^2$, both the mean recall of the labeled lakes and the mean precision of the predicted lakes exceed 86\%, and improve as lake size increases. Notably, in 1–20 km$^2$ size group, the mean recall is 93.1\%, slightly lower than the 95.5\% observed in the [0.1 - 1 km$^2$] size group.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\linewidth]{figure/Figure5_validation_2.eps}
    \caption{Validation in lake-entity of the deep-learning algorithm. (a) The area of each label and each predicted polygon and its corresponding true predicted area. (b) The mean recall of labels and mean precision of predicted polygons in different lake size groups.}
    \label{fig:Fig5}
\end{figure}

\subsection{Global lake abundance and distribution}
\label{subsec32}

%GLAKESplus囊括了~12 million个面积大于0.005km2的湖泊，总面积约3.4×106 km2。同先前研究一致，全球湖泊面积由大湖泊(面积>100 km2)占主导，贡献了56.1%的湖泊总面积 (Fig. 6a)。而在数量上，全球湖泊由小湖泊(面积<1 km2)主导，占据了98.3%(Fig. 6b)，其中，其他公开数据集没有囊括的小于0.01km2的湖泊贡献了全球湖泊数量的32.6%。Fig6展示了GLAKESplus的湖泊数量、面积在1°×1°格网上的空间分布及经度、纬度剖面上的分布。全球湖泊的49%或湖泊总面积的30%位于57°N以北的高纬度地区，主要分布在加拿大地盾、斯堪的纳维亚地区及西西伯利亚平原地区。在57°N以南地区，湖泊数量逐渐减少，而湖泊面积直至36°N开始减少。在30°N、22°N附近，存在湖泊数量的小高峰，主要由北美洲密西西比平原及长江中下游平原的小湖泊所贡献 。热带地区湖泊数量及总面积都较少，但仍有几个密集分布区域，如中国南方沿海地区、柬埔寨及印度东部沿海地区。南美洲亚马逊河流域及非洲的东非大裂谷存在一些大湖泊，使得纬度剖面总面积在1~5°S之间存在一个小峰值(Fig. 6c)。在经度剖面上，有54%的湖泊（或48%的湖泊面积）分布在西半球（-20°W-160°E）；东半球湖泊面积在29~35°E及49~53°E有两个高峰值，湖泊数量则在66~120°E之间存在多个峰值(Fig. 6d)。
GLAKESplus includes about 12 million lakes larger than 0.005 km$^2$, with a total lake area of ~$3.4 \times 10^6\, \text{km}^2$. Consistent with previous studies, large lakes ($\ge 100\, \text{km}^2$) dominate global lake area (accounting for 56.1\%; Figure \ref{fig:Fig6}a), while small lakes ($\le 1\, km^2$) overwhelmingly dominate the global lake count (accounting for 98.3\%; Fig. \ref{fig:Fig6}b), with lakes smaller than 0.01 km$^2$ (not covered by existing publicly available datasets) contributing 32.6\% of the total lake count. The spatial distribution of lake count and total area in GLAKESplus is shown within 1° × 1° grid cells, as well as their longitudinal and latitudinal profiles. Globally, 49\% of global lakes or 30\% of total lake area are located north of 57°N, mainly distributed in the Canadian Shield, Scandinavia, and Western Siberian Plain; South of 57°N, lake count gradually decreases, while lake area remains stable until 36°N, after which it begins to decline; Small peaks in lake count appear around 30°N and 22°N, mainly contributed by dense lake distributions in the Mississippi River Basin (North America) and the lower Yangtze River floodplain (Asia). In tropical regions, both lake count and total area are relatively low, but several high-density regions exist, such as coastal southern China, Cambodia, and eastern India. Additionally, the presence of large lakes in the Amazon Basin (South America) and the East African Rift (Africa) results a small peak in lake area between 1°S and 5°S. In the longitudinal profiles, 54\% of global lakes (or 48\% of total lake area) are distributed in the Western Hemisphere (-20°W to 160°E). In the Eastern Hemisphere, lake area exhibits two prominent peaks at 29–35°E (East African Rift lakes,) and 49–53°E (Caspian Sea), while lake count shows multiple peaks between 66–120°E (Fig. \ref{fig:Fig6}d).

\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\linewidth]{figure/Figure6 global lake distribution.png}
    \caption{Spatial distribution of GLAKESplus. Lakes in GLAKESplus were mapped, showing (a) lake area density (total lake area/grid area) and (b) lake count per 1°×1° grid cell. The latitudinal and longitudinal lake profile, summarizing global lake count and total lake area by 1°, were shown in (c) and (d), while (a) and (b) present the statistics for small ($\le 1 \,\text{km}^2$), medium (1–100 km$^2$), and large ($\ge 100 \,\text{km}^2$) lakes, respectively.}
    \label{fig:Fig6}
\end{figure}

\subsection{Comparison with other global lake databases}
\label{subsec33}

%我们将GLAKESplus与GLAKES、PLD进行比较，从而了解其在描绘全球湖泊分布上的优势与劣势。我们首先对比了三个数据集的湖泊在不同尺度组上的总数量及总面积差异（Fig. 7），以及像素尺度上的不同（Fig. 8）。需要指出，三个数据集的湖泊边界定义有所不同。在大于0.01km2的尺度组中，三个数据集的湖泊数量随着尺度减少而增加，总面积则有所减少。三个数据集皆有16个面积大于10000 km2的湖泊，但PLD对应的总湖泊面积略少于另外两个数据集(Fig. 7)。在其余尺度组中，GLAKESplus的湖泊总数量及总面积皆大于另外两个数据集，且数量面积差异随湖泊尺度减小而增加。GLAKES未囊括小于0.3km2的湖泊，在0.01-1km2的尺度组中湖泊总数量及面积皆最小，但在其余数量组中皆高于PLD。GLAKESplu描绘出了390万个PLD未覆盖的小于0.01km2的湖泊，总湖泊面积达27643km2。
We compared GLAKESplus with GLAKES and PLD to evaluate its strengths and limitations in representing global lake distributions.The comparison involved differences in total lake count and  lake area across different size groups (Fig. \ref{fig:Fig7}) as well as pixel-scale boundary differences (Fig. \ref{fig:Fig8}). It should be noted that the three datasets define lake boundaries differently. For lakes larger than 0.01 km$^2$, all three datasets showed an increase in lake count and a decrease in total lake area as size decreased. All datasets contained 16 lakes larger than 10,000 km$^2$, but the total lake area in PLD was slightly smaller than that in GLAKESplus and GLAKES. In other size groups, GLAKESplus consistently included more lakes and a larger total area than the other datasets, with the differences increasing as lake size decreased. GLAKES did not include lakes smaller than 0.3 km$^2$, resulting in the smallest lake count and area in the 0.01–1 km$^2$ size group, whereas it exceeded PLD in all other size groups; Compared to PLD, GLAKESplus mapped an extra 3.9 million lakes smaller than 0.01 km$^2$, with a total lake area of 27,643 km$^2$. 

%像素尺度上，10m空间分辨率的GLAKESplus的湖泊边界比30m空间分辨率的GLAKES、PLD更精细。在池塘密布区域（如中国长江流域，Fig. 8a），GLAKESplus全面、准确地描绘了小湖泊边界，GLAKES表现欠佳，PLD则未将其纳入考虑。对于干旱区的盐湖，PLD和GLAKES有部分缺失，GLAKESplus融合了GLAKES与PLD的结果，湖泊边界更全面（Fig. 7b）。在少部分洪泛平原（如鄂毕河下游 Fig. 8c）及气候干旱的内陆地区（如阿根廷东部地区Fig. 8d），GLAKES及PLD预测的湖泊数量及面积多于GLAKESplus，包括许多平均NDWI偏低的湖泊。
At pixel-level scale (Fig. \ref{fig:Fig8}) , GLAKESplus provided more detailed lake boundaries than GLAKES and PLD due to higher spatial resolution (30 m to 10 m). In pond-dense regions, such as the Yangtze River Basin in China (Fig. \ref{fig:Fig8}a), GLAKESplus accurately and comprehensively delineated small lake boundaries, while GLAKES underperformed, and PLD did not account for these ponds at all. For salt lakes in arid regions, GLAKES and PLD showed partial omissions, whereas GLAKESplus integrated lakes from GLAKES and PLD, leading to more comprehensive lake boundaries (Fig. \ref{fig:Fig8}b). In some floodplain regions (e.g., the lower Ob River floodplain; Fig. \ref{fig:Fig8}c) and semi-arid regions (e.g., eastern Argentina; Fig. \ref{fig:Fig8}d), the lake count and area of GLAKES and PLD are larger than GLAKESplus, however, GLAKESplus omitted these lakes with low NDWI value in sentinel-2 mean imagery.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\linewidth]{figure/Figure7 comparison of three database.png}
    \caption{Comparisons of lake count and area in different size groups among GLAKESplus, GLAKES and PLD.}
    \label{fig:Fig7}
\end{figure}

\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\linewidth]{figure/Figure8 three_dataset_compare.png}
    \caption{Regional comparison among GLAKESplus, GLAKES and PLD. (a) Ponds in the Yangtze River Basin. (b) The Uyuni Salt Flat in Bolivia. (c) Lakes in the lower Ob River floodplain. (d) Seasonal lakes in eastern Argentina. For (a-d), the left figures show the NDWI basemap and lake extend of GLAKES and PLD, the right figures show the RGB basemap and lake extend of GLAKESplus.}
    \label{fig:Fig8}
\end{figure}

% 我们对PLD与GLAKESplus在不同尺寸组的湖泊进行更详细的空间比较（Fig 9）。在大于0.1km2的尺寸组中，GLAKESplus沿经度、纬度的湖泊总数量、面积分布与PLD整体较为接近，在东经60度左右，GLAKESplus的湖泊总面积显著高于PLD；在0.01-0.1 km2 的尺寸组中，GLAKESplus沿经度、纬度的湖泊总数量、面积分布皆高于PLD，在东经120度左右GLAKES湖泊总面积显著高于PLD (Fig. 9a, b, d, e)。GLAKESplus额外绘制的小于0.01km2的湖泊进一步凸显了两个数据集在小湖泊描绘方面的差异。对比两个数据集在0.01-0.1km2尺度组的湖泊在1°×1°的格网内的分布差异（Fig. 9c），结果表明GLAKESplus的小湖泊数量及面积在大部分区域高于PLD，尤其在中国长江流域、印度东部及东南亚地区，在前文提及的少部分洪泛平原及气候干旱的内陆地区，GLAKESplus该尺度组湖泊总数量和面积偏少。
We conducted a more detailed spatial comparison between GLAKESplus and PLD (Fig. \ref{fig:Fig8}). For lakes larger than 0.1 km$^2$, the total lake count and area distributions along latitude and longitude in GLAKESplus are generally similar to those in PLD, but for lakes smaller than 0.1 km$^2$, GLAKESplus exhibits significantly higher values than PLD (Fig. \ref{fig:Fig9}a, b, d, e). We further compared the total area and count of lakes with area between 0.01~0.1 km$^2$, which are included in both datasets, within 1° × 1° grid cells (Fig. \ref{fig:Fig8}c). The results indicate that, except for a few floodplains (e.g., ) and arid inland regions mentioned earlier, GLAKESplus contains more lakes and a greater total lake area than PLD across nearly global regions. The differences are particularly pronounced in the Yangtze River Basin in China, eastern India, the Mississippi River basin, and xxx 

\begin{figure}[t]
    \centering
    \includegraphics[width=0.8\linewidth]{figure/Figure9.png}
    \caption{The differences in the spatial distribution of total lake area and count between GLAKESplus and PLD. Lake count of two databases (a) per latitudinal degree and (b) per longitude degree. Total lakes area of two databases (d) per latitudinal degree and (e) per longitude degree. For (a, b, d and e), lakes greater than 0.1 km$^2$ and smaller than 0.1 km$^2$ were plotted on opposite axes, with the axes were stretched for better visual presentation. GLAKESplus was represented by stacked bar charts figure in different colors, while PLD was represented by line charts in different colors and line widths. (c) The difference of count and total area of lakes in the [0.01 - 0.1 km$^2$] size group between two databases per 1°×1° grid cell. Notably, the Caspian Sea was excluded, which contains the Garabogazköl lagoon.}
    \label{fig:Fig9}
\end{figure}

\section{Discussion and Conclusions}
\label{sec4}

%基于2017年3月28日至2022年4月10日之间的sentinel-2卫星数据和深度学习方法，我们提出了首个10m分辨率全球湖泊数据集GLAKESplus，包含约12million个大于0.005km2的湖泊，总面积达到3.4×106km2。精度评价结果表明我们的模型有较高的准确性。模型在测试集上的精度指标Recall，precision，F1score大于92.75，IoU大于82.7。
Based on a deep learning algorithm  and Sentinel-2 satellite data collected between March 28, 2017 to April 10, 2022, we proposed the first 10 m resolution global lake database. GLAKESplus contains ~12 million lakes larger than 0.005 km$^2$, covering a total area of  $3.4 \times 10^6\, \text{km}^2$. Accuracy assessments indicate that our model achieves high accuracy, with recall, precision, and F1-score exceeding 92.75 and an IoU above 82.7 on the test set. 

%但模型在部分区域存在一些缺陷。受限于相对小的输入影像，模型对大尺度的水体的区分存在挑战性，导致模型将部分大河宽的河流识别为湖泊（模型precision在AR类别中为89.77%）及漏分具有河流特征的部分大湖泊（模型在大于1km2的标签中的平均召回率为93.1%，稍低于较小的尺寸组）。提升输入尺寸会显著提高对GPU memory的需要，576×576是我们的GPU内存（48GB）能训练的最大输入尺寸。此外，模型存在对盐湖的漏分现象（SL的召回率低至72.71%），因为盐湖的特征与陆地相似。我们通过一系列后处理操作减少了模型的错分、漏分现象。首先，海洋、河流掩膜操作有效去除了海洋及河流残渣，测试集精度结果表明河流掩膜操作将precision提升了1.77%；其次，我们删除了平均召回率和平均准确性低于85%的小于0.005km2的polygon，提高模型准确性。最后，我们通过湖泊补全操作补全了GLAKESplus中的大湖泊及干旱区湖泊，得到了更全面的湖泊边界。此外，我们进行了大量人工检查来保证制图结果的准确性。
However, our model exhibits some limitations in certain regions for our raw prediction. Specifically, due to the relatively small input image size, the model faces challenges in distinguishing large-scale water bodies. This results in the misclassification of some wide rivers as lakes (with a precision of 89.77\% in AR regions) and the omission of certain large lakes with river-like characteristics (with an average recall of 93.1\% for test labels with size $\ge 1\, \text{km}^2$, slightly lower than that of smaller size groups). Increasing the input size would significantly raise GPU memory demands, and 576 × 576 pixels was the largest input size our GPU memory (48 GB) can support during training. Additionally, our model omitted some salt lakes (with a recall of 72.71\% in SL regions) due to their spectral characteristics being similar to those of land. Fortunately, our post-processing operations effectively reduced the omission and commission errors of the raw prediction. First, ocean and river residuals were effectively removed by other databases. The river masking operation improving the precision of test regions by 1.77\%. Second, polygons smaller than 0.005 km$^2$ were deleted, since the mean recall of labels and mean precision of predictions both below 85\%. Finally, a lake completion procedure was implemented to restore boundaries for large lakes and arid-region lakes, ensuring more comprehensive lake delineation. Additionally, we conducted extensive manual inspections to ensure the accuracy of the mapping results.

%相对于现有的全球公开湖泊数据集，GLAKESplus有更高的空间分辨率（10 m），覆盖更多小湖泊（将最小湖泊覆盖单元提升至0.005km2）。和先前的研究一致，全球湖泊的面积由大湖泊主导，数量则由小湖泊占主导，对小湖泊的全面描绘进一步突出了其重要性（贡献了全球98%的湖泊面积）。GLAKESplus的湖泊数量及湖泊总面积在各个尺度组中皆高于GLAKES和PLD，并在空间上提供了更细节的湖泊分布信息。一个重要亮点是，GLAKESplus全面描绘了在长江中下游平原及东南亚沿海地区的大量池塘，而这些湖泊在PLD和GLAKES中被低估。但GLAKES也存在一些缺陷，在部分区域的湖泊预测低于GLAKES与PLD。比如在一些洪泛平原，GLAKESplus倾向于预测常年有水的区域；而在部分气候干旱的区域，GLAKESplus忽略了季节性出现或已干涸的湖泊。此外，相对于GLAKES，GLAKESplus只有一个时相的信息，不能提供湖泊的动态变化。
Compared to existing global lake databases \citep{verpoorter_global_2014,messager_estimating_2016,sheng_representative_2016,pi_mapping_2022,wang_global_2022}, GLAKESplus offers a significant improvement in spatial resolution (10 m) and provides the most comprehensive coverage of small lakes to date. Lakes with size $\le$ 1 km$^2$ contribute 98\% of the global lake count, further highlighting the importance of small lakes. GLAKESplus surpasses GLAKES and PLD in both the lake count and total lake area across all size groups, while also providing more detailed spatial distribution information. A key highlight is that GLAKESplus comprehensively maps numerous ponds in the middle and lower Yangtze River Plain and the coastal regions of Southeast Asia, which are underestimated in PLD and GLAKES. However, GLAKESplus also has some limitations. In certain areas, its lake extent predictions are lower than those of GLAKES and PLD. For example, in some floodplains, GLAKESplus tends to predict only perennial water bodies, while in arid regions, it tends to overlook seasonal or dried-up lakes. Additionally, unlike GLAKES, GLAKESplus provides only a single temporal period, lacking information on lake dynamics over time.

%GLAKESplus的全球湖泊分布信息，有助于内陆湖泊碳通量的准确评估，能为气候变化、内陆水域的生物地球化学研究提供数据支持，对全球水资源保护有重要意义。未来的研究将会专注于如何增强模型区分不同尺度地物的能力，并尝试将全球湖泊10m分辨率制图方法推广到不同的研究时间段，对全球湖泊进行动态监测。
The global lake distribution information provided by GLAKESplus contributes to the accurate assessment of inland lake carbon fluxes, supports research on climate change and the biogeochemistry of inland waters, and is of great significance for global water resource conservation. Future research will focus on enhancing the model's ability to distinguish lakes at different scales and extending the 10 m resolution global lake mapping method to different time periods for dynamic monitoring of global lakes. 


\bibliographystyle{elsarticle-harv.bst}
\bibliography{reference.bib}
\end{document}

\endinput
%%
%% End of file `elsarticle-template-harv.tex'.


